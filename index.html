<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Concrete AR Demo</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>
    <style>body{margin:0;overflow:hidden;}</style>
  </head>

  <body>
    <a-scene
      embedded
      renderer="logarithmicDepthBuffer: true; colorManagement: true; shadowMapEnabled: true;"
      arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false; smoothing: true; smoothingFactor: 0.1;"
    >

      <a-assets>
        <a-asset-item id="columnModel" src="column.glb"></a-asset-item>
      </a-assets>

      <!-- نورها -->
      <a-entity light="type: ambient; intensity: 0.7"></a-entity>
      <a-entity light="type: directional; intensity: 1" position="1 3 2"></a-entity>

      <a-marker type="pattern" url="pattern-concrete.patt">

        <!-- wrapper که کلیک را دریافت می‌کند -->
        <a-entity id="columnWrapper" position="0 0 0" rotation="-90 0 0" column-interaction>
          <!-- مدل داخل wrapper -->
          <a-entity id="columnModelEntity" gltf-model="#columnModel" scale="0.03 0.03 0.03" position="0 0 0"></a-entity>
        </a-entity>

        <!-- متن مشخصات (از &#10; برای newline در HTML استفاده شده) -->
        <a-text id="infoText"
                value="ستون 30x30 &#10; میلگرد Φ16 &#10; بتن C30"
                position="0 1.2 0"
                align="center"
                color="yellow"
                visible="false"
                wrap-count="20"
                >
        </a-text>

        <!-- صفحه شفاف برای دریافت سایه/کلیک بهتر -->
        <a-plane id="touchPlane" position="0 0 0" rotation="-90 0 0" width="2" height="2" opacity="0" material="opacity:0"></a-plane>

      </a-marker>

      <!-- دوربین و raycaster اشاره‌گر روی wrapper -->
      <a-entity camera look-controls cursor="rayOrigin: mouse" raycaster="objects: #columnWrapper, #touchPlane"></a-entity>

    </a-scene>

    <script src="app.js"></script>
  </body>
</html>
